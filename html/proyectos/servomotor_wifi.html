<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Título de tu página</title>
    <link rel="stylesheet" href="../../css/proyectos/styles_termometro.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">
</head>
<body>
    <header>
        <div class="header-content">
            <img src="../../images/logo.png" alt="Descripción de la imagen" style="height: 100px;width: auto;">
        </div>
    </header>
    <nav class="menu">
      <ul class="nav-list">                  
          <li><a href="../../index.html" class="inicio">INICIO</a></li>
          <li><a href="../conceptos.html" class="conceptos">BLOGS</a></li>
          <li><a href="../proyectos.html" class="proyectos">PROYECTOS</a></li>
          <li> <a href="../servicios.html" class="servicios">SERVICIOS</a></li>
          <li><a href="../descargas.html" class="descargas">DESCARGAS</a></li>
          <li><a href="../donaciones.html" class="donaciones">DONACIONES</a></li>
      </ul>
  </nav>
    <section>
      <div class="contenedor">
        <h2 id="titulo">Barrido de un LED</h2>
        <h2 id="subtitulo">Descripción</h2>
        <p id="texto_1">Este proyecto consiste en la manipulación del eje de un servomotor desde un navegador, para ser controlado requiere de una señal PWM, existen librerías que fueron desarrolladas para controlar el servomotor a diferntes grados.</p>
        <h3>Materiales necesarios:</h3>
        <ul>
          <li>ESP32 (cualquier versión)</li>
          <li>Servomotor SG90</li>
          <li>Fuente de alimentación de 5V</li>
          <li>Controlador de servomotor (solo si se utiliza servomotores de más potencia)</li>
          <li>Protoboard y cables de conexión</li>
        </ul>
        <h3>Instrucciones:</h3>
          <ol>
             <li>Identifica los pines del servomotor (VCC, SIGNAL, GND).</li>
             <li>El pin VCC debe estar conectado a 5v y GND a tierra, el SIGNAL debe ir conectado a un pin PWM del Arduino.</li>
             <li>Se recomienda utilizar una fuente externa para alimentar al servomotor, caso contrario puede dañar a la placa Arduino o al computador.</li>
             <li>Instale las librerias necesarias que se muestran en la cabecera.</li>
             <li>Carga el código en el Arduino.</li>
             <li>Ingrese al monitor serial, verifique la conexión a internet y copie la dirección IP.</li>
             <li>Abra el navegador, pegue la dirección IP y disfrute.</li>
          </ol>
          <h3>Esquema de conexión</h3>
          <img src="../../images/esp32_servomotor.png"> 
          <h3>Código de Ejemplo (para Arduino IDE):</h3>
          <div class="container">
          <div class="controls">
            <button onclick="copyCode()">Copiar</button>
          </div>
          <div class="code-container">
            <div class="message" id="message">Copied</div>
            <pre id="code-block" class="line-numbers"><code class="language-c" style="color: black;">
/*
  Creado: Luis  Alvarez (edualv1723@gmail.com)
  https://alvelectronics.com
*/

#include &lt;WiFi.h&gt;
#include &lt;WebServer.h&gt;
#include &lt;ESP32Servo.h&gt;

const char* ssid = "TuSSID";
const char* password = "TuPassword";

WebServer server(80);
Servo servo;

const int servoPin = 14; 
int angulo = 90; // Posición inicial

void handleRoot() {
  String html = "<!DOCTYPE html><html><head><meta charset='UTF-8'><title>Control Servo</title></head><body>";
  html += "<h1>Control de Servomotor - ESP32</h1>";
  html += "<input type='range' min='0' max='180' value='" + String(angulo) + "' id='slider' oninput='sendValue(this.value)'>";
  html += "<p>Ángulo: <span id='val'>" + String(angulo) + "</span>°</p>";
  html += "<script>";
  html += "function sendValue(val){document.getElementById('val').innerText=val;fetch('/set?value='+val);}";
  html += "</script></body></html>";
  server.send(200, "text/html", html);
}

void handleSet() {
  if (server.hasArg("value")) {
    angulo = server.arg("value").toInt();
    servo.write(angulo);
    Serial.printf("Ángulo: %d°\n", angulo);
  }
  server.send(200, "text/plain", "OK");
}

void setup() {
  Serial.begin(115200);

  servo.attach(servoPin);
  servo.write(angulo);

  WiFi.begin(ssid, password);
  Serial.print("Conectando a WiFi");
  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }
  Serial.println();
  Serial.print("Conectado, IP: ");
  Serial.println(WiFi.localIP());

  server.on("/", handleRoot);
  server.on("/set", handleSet);

  server.begin();
  Serial.println("Servidor HTTP iniciado");
}

void loop() {
  server.handleClient();
}


      </code></pre>
          </div>
        </div>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/prism.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
        <script>
           function copyCode() {
                var codeBlock = document.getElementById('code-block').innerText;
                navigator.clipboard.writeText(codeBlock).then(function() {
                  showMessage();
                }, function() {
                  alert('Error al copiar el código');
                });
              }
              function showMessage() {
                var message = document.getElementById('message');
                message.classList.add('show-message');
                setTimeout(function() {
                  message.classList.remove('show-message');
                }, 1000);
              } 
      
        </script>
      </div>
    </section>
    <footer>
        <p>Derechos de autor © 2024 - Luis Alvarez</p>
    </footer>
    <a href="https://wa.link/epa3e7" class="whatsapp-button" target="_blank">
      <img src="../../images/boton_whatsapp.png" alt="Whatsapp">
    </a>
    <script src="js/script.js"></script> <!-- Asegúrate que la ruta refleja la estructura de carpetas -->
</body>
</html>
